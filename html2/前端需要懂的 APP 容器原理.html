<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.3.4 (460189)"/><meta name="keywords" content="微信"/><meta name="created" content="2020-06-07 14:16:15 +0000"/><meta name="source-application" content="微信"/><meta name="source-url" content="https://mp.weixin.qq.com/s/_m_rf7xlSeVZO1NK58Z7lQ"/><meta name="updated" content="2020-06-07 14:16:15 +0000"/><title>前端需要懂的 APP 容器原理</title></head><body style="margin:0px;"><div style="padding:8px 0px;margin:8px auto;max-width:700px;"> <div style="margin:0;padding:0;background-color:#fff"><div style="margin:0;padding:0"><div style="margin:0;padding:0;position:relative"><h2 style="font-weight:400;margin:0;padding:0;font-size:22px;line-height:1.4;margin-bottom:14px"> 前端需要懂的 APP 容器原理 </h2><div style="margin:0;padding:0;margin-bottom:22px;line-height:20px;font-size:0;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto"><span style="padding:0;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative"><a style="margin:0;padding:0;color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)"> 奇舞周刊 </a></span><em style="padding:0;font-style:normal;display:inline-block;vertical-align:middle;margin:0 10px 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0);color:rgba(0,0,0,0.3)"/></div><div style="margin:0;padding:0;margin-bottom:24px;font-size:15px"><p style="margin:0;padding:0;line-height:1.4;color:rgba(0,0,0,0.3)"><span style="margin:0;padding:0">以下文章来源于Fliggy F2E</span><span style="margin:0;padding:0">，作者孝瓘</span></p><a href="https://mp.weixin.qq.com/s/_m_rf7xlSeVZO1NK58Z7lQ#" style="margin:0;color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative;background-color:#f7f7f7;border-radius:8px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:20px 16px;margin-top:16px;line-height:1.4;-webkit-box-align:center;-webkit-align-items:center;align-items:center;display:flex"><div style="margin:0;padding:0"><span style="display:inline-block;background-color:#fff;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;overflow:hidden;margin:0;padding:0;width:40px;height:40px;margin-right:12px;vertical-align:middle"><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/0.jpg" height="640" width="640"/></span></div><div style="margin:0;padding:0;min-width:0;-webkit-box-flex:1;-webkit-flex:1;flex:1"><strong style="margin:0;padding:0;color:rgba(0,0,0,0.9);font-size:17px;font-weight:700;width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;display:block">Fliggy F2E</strong><p style="margin:0;padding:0;color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal">飞猪前端官方公众号</p></div></a></div><div style="margin:0;padding:0;overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0;__visibility:hidden"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:16px;color:black;padding-right:10px;padding-left:10px;line-height:1.6;letter-spacing:0;word-break:break-word;overflow-wrap:break-word;text-align:left;font-family:Optima-Regular,Optima,PingFangSC-light,PingFangTC-light,&quot;PingFang SC&quot;,Cambria,Cochin,Georgia,Times,&quot;Times New Roman&quot;,serif;margin-top:-10px"><blockquote style="max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;padding-top:4px;margin:1em 0;font-size:0.9em;overflow:auto;background:rgba(0,0,0,0.05);padding:10px 1em;border-left-color:rgb(221,221,221);margin-top:1.2em;margin-bottom:1.2em;border-left-width:4px;color:rgb(119,119,119);quotes:none"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;white-space:normal;text-size-adjust:auto;font-size:15px;font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;line-height:1.75em">本文来自阿里巴巴飞猪前端专家@孝瓘，在移动端容器建设有深厚的经验，热爱<strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:black">前端/iOS/Android 开发，从端视角负责过飞猪H5/RN/Weex/小程序/Flutter容器的建设</strong>，本文试图从前端视角，向读友揭一揭“App 容器”的面纱，欢迎大伙一起交流。</p></blockquote><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">App 容器，简言之，App 承载某类应用（H5/RN/Weex/小程序/Flutter ...）的运行环境，可主动干预并进行功能扩展，达到丰富能力、优化性能、提升体验的目的，如页面数据预取（prefetch）缩短页面可用耗时、WebAR 将 AR 能力赋予 H5、Native 地图与 H5 复合渲染交互。</p><table style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><thead style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:white"><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:center">数据预取</th><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:center">WebAR 能力</th><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:center">Native 与 H5 复合</th></tr></thead><tbody style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:0;border-style:initial;border-color:initial"><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:white"><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center"><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/640_1.gif" height="250" width="300"/></td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center"><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/640.gif" height="240" width="120"/></td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center;word-break:break-all"><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/640_2.gif" height="667" width="375"/></td></tr></tbody></table><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">本篇主要就 H5 容器（WebView）相关建设进行概要展开。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">我们先来做一个类比，通过 H5 的视角简要看一看 Android、iOS，进而更容易理解 WebView 容器建设机理。</p><table style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><thead style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:white"><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:right">内容</th><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:center">H5</th><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:center">Android</th><th style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-top-width:1px;border-color:rgb(204,204,204);background-color:rgb(240,240,240);text-align:center">iOS</th></tr></thead><tbody style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:0;border-style:initial;border-color:initial"><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:white"><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:right">窗口</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">Window</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">PhoneWindow</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">UIWindow</td></tr><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:rgb(248,248,248)"><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:right">页面控制</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">Html</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">Activity</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">UIViewController</td></tr><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:white"><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:right">内容区</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">body</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">contentView(DecorView)</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">view</td></tr><tr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:1px 0 0;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-top-style:solid;border-top-color:rgb(204,204,204);background-color:rgb(248,248,248)"><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:right">常规 UI(容器、文本、图片)</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">div、content、img</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">View、TextView、ImageView</td><td style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-color:rgb(204,204,204);text-align:center">UIView、UILabel、UIImageView</td></tr></tbody></table><blockquote style="max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;padding-top:4px;margin:1em 0;font-size:0.9em;overflow:auto;background:rgba(0,0,0,0.05);padding:10px 1em;border-left-color:rgb(221,221,221);margin-top:1.2em;margin-bottom:1.2em;border-left-width:4px;color:rgb(119,119,119);quotes:none"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;white-space:normal;text-size-adjust:auto;font-size:15px;font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;line-height:1.75em">通过如上对比可知，Native 与 H5 有很多相通之处的，如：H5 是一个 html 创建一个页面；Android 是一个 Activity 创建一个页面；iOS 是 UIViewController 创建一个页面。不同处在于， Native 本身有完善的页面栈管理机制，在同一个 runtime 环境里控制页面间转换；还可以管理多个窗口(Window)，有多线程/进程(仅 Android)辅助合理使用资源保障主线程/进程性能，是 App 的体验。而 H5 本身受运行环境限制，只能在一个窗口里活动，目前缺少同一个 Runtime 内成熟的页面栈管理机制，当前 SPA 方式切换 view 来模拟“页面转场”，已是 WebApp 体验的一种较佳实现了。所以，在 App 里，H5 期望能借助更多的 Native 能力。</p></blockquote><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">在 App 里，是通过 WebView 来访问 h5 页面的，先来看一下 WebView 的官方释义：</p><blockquote style="max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;padding-top:4px;margin:1em 0;font-size:0.9em;overflow:auto;background:rgba(0,0,0,0.05);padding:10px 1em;border-left-color:rgb(221,221,221);margin-top:1.2em;margin-bottom:1.2em;border-left-width:4px;color:rgb(119,119,119);quotes:none"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;white-space:normal;text-size-adjust:auto;font-size:15px;font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;line-height:1.75em">A View that displays web pages. This class is the basis upon which you can roll your own web browser or simply display some online content within your Activity. It uses the <strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:black">WebKit rendering engine</strong> to display web pages and includes methods to navigate forward and backward through a history, zoom in and out, perform text searches and more.</p></blockquote><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">其实，WebView 在 Android/iOS 两端的实现，都是继承自其 View/UIView 基类。对于 Native 原生来说，WebView 本身通过加载 h5 页面、通过 Chromium/WebKit 内核解析并进行 UI 合成，生成 view，Activity/UIViewController 实例的 View 通过 addView(Android)/addSubview(iOS)将 web view 添加进视图层，UI 合成，然后上屏展示。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">我们知道，App 可以使用系统能力，但 WebView（类比浏览器）出于安全等考虑，默认并不提供。我们建设容器的一个主要目的是将 App 这些可用能力开放给容器。下面就谈一谈这部分能力是如何提供出来的，也就是下面要讲的桥通道相关建设。</p><hr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:1px;margin-top:10px;margin-bottom:10px;border-right:none;border-bottom:none;border-left:none;border-top-style:solid;border-top-color:black"/><h2 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:22px;margin:10px auto;height:40px;background-color:rgb(251,251,251);border-bottom:1px solid rgb(246,246,246);overflow:hidden"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-left:-10px;display:inline-block;width:auto;height:40px;background-color:rgb(33,33,34);border-bottom-right-radius:100px;color:rgb(255,255,255);padding-right:30px;padding-left:30px;line-height:40px;font-size:16px">桥通道</span></h2><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">桥有接连之义，将本不互通的二者通过桥连通起来，形象化的描述了“App 能力”以“通道”的形式输送给容器使用，本质上就是如何让我们的 H5 能够使用这些能力。下面分开来看两端的实现思路：</p><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">Android</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">通过  WebView  的  addJavascriptInterface  方法来建立 Java 与 JS 对象映射关系互通。对系统版本要求 4.2+ ，主流 App 基本都基于 5+适配了，兼容低版本的方案就略过了。如下：</p><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">定义与  WebView JS 上下文（即 window 挂载对象）建立映射关系的 Android JavascriptInterface 实现类及 call 方法</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">package</span> ...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">import</span> android.webkit.JavascriptInterface;<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">public</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">class</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">JSBridgeChannel</span> </span>{<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">@JavascriptInterface</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// JS侧JSON.stringify序列化处理options对象</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">public</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">void</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">call</span><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px">(String api, String options)</span></span>{<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//根据api及传递过来的参数处理Native对应的功能</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        ...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    }<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>}<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">在 WebView 的 loadUrl 时机（保证 H5 JS 运行前桥通道已准备 ok），通过  WebView  的  addJavascriptInterface  方法建立 Android 类实例对象 与 JS 对象 的映射关系</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">@Override</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">public</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">void</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">loadUrl</span><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px">(String url)</span> </span>{<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    ...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//…构造函数所需参数；AliJSBridge 为JS映射对象名</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    mWebView.addJavascriptInterface(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">new</span> JSBridgeChannel(…), <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">"JSBridge"</span>);<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>}<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">WebView 里 JS 即可同步调用</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">window</span>.JSBridge.call(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">"api"</span>, <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">JSON</span>.stringify(options));<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li></ol><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">也可以借助 Android 系统 提供的 JS 在调试 Native 代码里面打印日志的 API onConsoleMessage，通过获取 message 来做通讯数据，但不推荐。</p><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">iOS</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">WKWebView 提供了 MessageHandler 方式来处理 JS 与 Native 的数据交互，其优点是同步调用，性能/稳定性更优，更少内存占用。对系统版本要求 iOS 8+，主流 App 基本都基于 9+适配了。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">WKWebView 在初始化时：<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">[[WKWebView alloc] initWithFrame:frame configuration:config]</code>，其配置参数<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">configuration</code> 是 WKWebViewConfiguration 类型参数，WKWebViewConfiguration 有一个属性叫 userContentController，是WKUserContentController类型参数，WKUserContentController 有个实例方法 <code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">[addScriptMessageHandler:name:](https://developer.apple.com/documentation/webkit/wkusercontentcontroller/1537172-addscriptmessagehandler?language=objc)</code>，官方释义清晰地说明了，其可建立起 JS 与 Native 的通讯通道：</p><blockquote style="max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;padding-top:4px;margin:1em 0;font-size:0.9em;overflow:auto;background:rgba(0,0,0,0.05);padding:10px 1em;border-left-color:rgb(221,221,221);margin-top:1.2em;margin-bottom:1.2em;border-left-width:4px;color:rgb(119,119,119);quotes:none"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;white-space:normal;text-size-adjust:auto;font-size:15px;font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;line-height:1.75em">Adding a script message handler with name name causes the JavaScript function window.webkit.messageHandlers.name.postMessage(messageBody) to be defined in all frames in all web views that use the user content controller.</p></blockquote><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">在 VC init 时机进行 WKWebView  初始化，创建 WKWebViewConfiguration 对象，配置 MessageHandler 对象。通过<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">addScriptMessageHandler:name:</code> 添加实现 WKScriptMessageHandler 协议的对象，以及被 JS 调用的方法名。注：记得在 VC dealloc 时，通过<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">removeScriptMessageHandlerForName</code> 移除释放。</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKWebViewConfiguration</span> *configuration = [[<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKWebViewConfiguration</span> alloc] init];<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//添加ScriptMessageHandler，即H5侧可以调用的方法bridge</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>[configuration.userContentController addScriptMessageHandler:<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">self</span> initWithDelegate:<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">self</span>] name:<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">@"bridge"</span>];<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//创建WKWebView</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>[[<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKWebView</span> alloc] initWithFrame:frame configuration:configuration];<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">实现<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">WKScriptMessageHandler</code>协议代理方法，当 JS 通过 window.webkit.messageHandlers 发送 Native 消息时，此方法会被调用</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">- (<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">void</span>)userContentController:(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKUserContentController</span> *)userContentController didReceiveScriptMessage:(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKScriptMessage</span> *)message{<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">if</span> ([<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">@"bridge"</span> isEqualToString:message.name]){<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//提取api</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">NSString</span> *api = [<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">NSString</span> stringWithString:message.body[<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">@"_api_"</span>]];<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//根据api及传递过来的参数去调用Native对应的功能</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        ...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    }<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>}<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">WebView 里 JS 即可同步调用</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">const</span> options = {<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//注意这里，是一个技巧性的处理方式，可以避免过多的messageHandlers注册</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>   _api_: ‘apiName<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">',<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>   ...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>};<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>window.webkit.messageHandlers['</span>bridge<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">'].postMessage(options);<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></span></code></pre></div></li></ol><h4 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:18px;margin:10px auto -1px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:16px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">统一桥 API 调用方式</span></h4><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">如上是两端通过同步方式向 WebView 的 JSContext 上，即 Window 上挂载了 JS 可以调用的对象方法，但两端的使用方式还是有差异。为了能够方便 H5 使用统一，两端还可以分别注入一段兼容封装的 JS 脚本，将两端的桥功能统一成 <code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">JSBridge.call(api, options, success, failure)</code> 形式调用。</p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">Android 侧 JS 脚本注入（在 mWebView.addJavascriptInterface 之后注入即可）：</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">String js = <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">"!(_ =&gt; {   // JS封装code })();"</span>;<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>mWebView.evaluateJavascript(js, <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">new</span> ValueCallback&lt;String&gt;() {<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">@Override</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">public</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">void</span> <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">onReceiveValue</span><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px">(String value)</span> </span>{<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        ...<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    }<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>});<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">iOS 侧 JS 脚本注入：</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">NSString</span> *js = <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">@"!(_ =&gt; {   // JS封装code })();"</span>;<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKUserScript</span> *script = [[<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKUserScript</span> alloc] initWithSource: js<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>                                              injectionTime:<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#e6c07b;line-height:26px">WKUserScriptInjectionTimeAtDocumentStart</span>  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// 注入时机按需配置即可：WKUserScriptInjectionTimeAtDocumentStart-&gt;刚开始创建 Dom 时；WKUserScriptInjectionTimeAtDocumentEnd -&gt; DomReady时</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>                                           forMainFrameOnly:<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#56b6c2;line-height:26px">NO</span>];<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>[_webView.configuration.userContentController addUserScript: script];<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li></ul><hr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:1px;margin-top:10px;margin-bottom:10px;border-right:none;border-bottom:none;border-left:none;border-top-style:solid;border-top-color:black"/><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em"><strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important">若对更底层的实现有兴趣，可以继续向下深入</strong>：</p><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">Android 下，Java 的 JVM 是 C/C++语言开发，V8 编程语言是 C++，提供了数据类型间转换的Value 类及其子类，在其官网 About V8 里也有明确说明：<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">V8 enables any C++ application to expose its own objects and functions to JavaScript code.</code>。与 Java 的JNI 同理。</p></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">iOS 下，Objective-C 是 C 语言的严格超集，支持 C++，JavaScriptCore 编程语言也是 C++，同样提供了数据类型间转换的JSValue 类，其官网释义也有明确说明：</p><blockquote style="max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;padding-top:4px;margin:1em 0;font-size:0.9em;overflow:auto;background:rgba(0,0,0,0.05);padding:10px 1em;border-left-color:rgb(221,221,221);margin-top:1.2em;margin-bottom:1.2em;border-left-width:4px;color:rgb(119,119,119);quotes:none"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;white-space:normal;text-size-adjust:auto;font-size:15px;font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;line-height:1.75em">A JSValue instance is a reference to a JavaScript value. ... You can also use this class to create JavaScript objects that wrap native objects of custom classes or JavaScript functions whose implementations are provided by native methods or blocks.</p></blockquote></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">C++ 几乎又是 C 的超集，在理解 JS 与 Java、OC 交互就明了了。以 V8 示例，比如实现一个 function 让 JS 调用：</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">V8 中，有两个模板 (Template) 类：对象模板 (ObjectTemplate) 与 函数模板 (FunctionTemplate) ，用以定义 JavaScript 对象和 JavaScript 函数。</p><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;background:rgba(27,31,35,0.05);display:-webkit-box;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// function 定义</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>Handle&lt;Value&gt; fn(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">const</span> Arguments&amp; args){<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">//do something</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>}<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// JSContext</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>Handle&lt;ObjectTemplate&gt; global = ObjectTemplate::New();<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// 将fn Binding到JSContext上，JS便可调用 fn 了</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>Handle&lt;FunctionTemplate&gt; fn_template = FunctionTemplate::New(fn);<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>global-&gt;Set(String::New(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#98c379;line-height:26px">"fn"</span>), fn_template);<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre></div></li></ul><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">通过桥通道支持，H5 便有了 App 级的能力，下面谈一点容器在性能上的优化建设-网络优化。</p><hr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:1px;margin-top:10px;margin-bottom:10px;border-right:none;border-bottom:none;border-left:none;border-top-style:solid;border-top-color:black"/><h2 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:22px;margin:10px auto;height:40px;background-color:rgb(251,251,251);border-bottom:1px solid rgb(246,246,246);overflow:hidden"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-left:-10px;display:inline-block;width:auto;height:40px;background-color:rgb(33,33,34);border-bottom-right-radius:100px;color:rgb(255,255,255);padding-right:30px;padding-left:30px;line-height:40px;font-size:16px">网络优化</span></h2><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">原生 Native 之所以体验平滑，有一关键点，是其页面依赖的静态资源大部分已打进安装包，跟随 App 的安装到了用户本地，节省了网络 IO 开销。顺着这个思路，在 5G 真正平民化之前，网络 IO 消耗，仍是提升性能的一个优化点，这块简要谈一下思路。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">主要是两方面：</p><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">静态资源，html/js/css/图片/字体/视频等，通过离线化、预加载、懒加载、开启 WebView 缓存复用等进行文件获取前置备用或复用，当前用户访问页面加载资源时，容器拦截资源网络请求，命中离线或缓存的资源文件并使用。离线化与预加载可直接节省首次网络 IO 性能消耗，其他方式可以节省二次网络 IO 性能消耗。</p></div></li><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px;color:black;list-style-type:disc"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1)">离线化：即像 Native 一个打进 App 安装包内</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1)">预加载：App 启动后，在页面使用前，提前加载资源到用户本地备用</div></li></ul><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;color:black;margin-bottom:16px;white-space:normal;text-size-adjust:auto;line-height:1.75em">接口数据预取，选择合适的时机在用户访问页面前将接口数据获取到，当用户进入页面时，拦截接口网络请求直接命中本地缓存数据并使用。</p></div></li></ol><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">这层优化，需要有配套的端远程控制机制与管理后台。合理设计总控机制，管控静态文件的发布、版本/patch 更新、下线等，以及接口数据预取的匹配规则、生命周期管理、静态/动态参数配置处理等。</p><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/640_1.png" height="815" width="1080"/><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">我们主要就静态资源网络优化实现，分端简要介绍一下实现思路，主要是对静态资源网络请求进行拦截处理：</p><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">Android</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">通过<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">shouldInterceptRequest</code>方法拦截处理（系统要求 4.0+），官方释义清晰明了：</p><blockquote style="max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:10px;border-left:3px solid #dbdbdb;padding-top:4px;margin:1em 0;font-size:0.9em;overflow:auto;background:rgba(0,0,0,0.05);padding:10px 1em;border-left-color:rgb(221,221,221);margin-top:1.2em;margin-bottom:1.2em;border-left-width:4px;color:rgb(119,119,119);quotes:none"><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;white-space:normal;text-size-adjust:auto;font-size:15px;font-family:-apple-system-font,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei UI&quot;,&quot;Microsoft YaHei&quot;,Arial,sans-serif;line-height:1.75em">Notify the host application of a resource request and allow the application to return the data. If the return value is null, the WebView will continue to load the resource as usual. Otherwise, the return response and data will be used.</p></blockquote><pre style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:10px;margin-bottom:10px"><code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;overflow-x:auto;padding:16px;color:#abb2bf;background:#282c34;display:-webkit-box;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;border-radius:0;font-size:12px;-webkit-overflow-scrolling:touch"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">@Override</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">public</span> WebResourceResponse <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#61aeee;line-height:26px">shouldInterceptRequest</span><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;line-height:26px">(WebView view, String url)</span> </span>{<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    WebResourceResponse response = <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">null</span>;<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">if</span>(<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// 匹配拦截规则){</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// 容器生成response</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#5c6370;font-style:italic;line-height:26px">// WebResourceResponse(String mimeType, String encoding, int statusCode, String reasonPhrase, Map&lt;String, String&gt; responseHeaders, InputStream data)</span><br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>        response =  <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">new</span> WebResourceResponse(...);<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    }<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>    <span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;color:#c678dd;line-height:26px">return</span> response;<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/>}<br style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"/></code></pre><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">iOS</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">受“官方”因素影响，iOS 的实现相对复杂些，了解过其发版审核的同学应该懂得的，这里就略过了。。。</p><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">注意事项</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">response 的 header 要处理正确</p><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">要正确处理拦截资源的 content-type</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">要正确处理拦截资源的<code style="margin:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:14px;overflow-wrap:break-word;padding:2px 4px;border-radius:4px;margin-right:2px;margin-left:2px;background-color:rgba(27,31,35,0.05);font-family:&quot;Operator Mono&quot;,Consolas,Monaco,Menlo,monospace;word-break:break-all;color:rgb(239,112,96)">Access-Control-Allow-Origin</code>，避免跨域资源校验问题</div></li></ol><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">接口数据预取本质上也是拦截识别处理，因为涉及静态/动态参数处理、有效期控制等，要复杂的多，这里就不再展开了。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">下面这块，我们概要性地谈一谈容器增强能力的建设~ WebAR 支持的实现思路：</p><hr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:1px;margin-top:10px;margin-bottom:10px;border-right:none;border-bottom:none;border-left:none;border-top-style:solid;border-top-color:black"/><h2 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:22px;margin:10px auto;height:40px;background-color:rgb(251,251,251);border-bottom:1px solid rgb(246,246,246);overflow:hidden"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-left:-10px;display:inline-block;width:auto;height:40px;background-color:rgb(33,33,34);border-bottom-right-radius:100px;color:rgb(255,255,255);padding-right:30px;padding-left:30px;line-height:40px;font-size:16px">WebAR</span></h2><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">在说 WebAR 之前，先看一下 AR。简要讲：AR 是通过启动摄像头获取现实环境，以视频帧的形式将现实环境数据传输给 识别模块 与 绘制模块，识别模块将识别结果数据传递给绘制模块（根据业务配置的识别规则处理成对应的虚拟事物），绘制模块将 现实环境数据与识别结果数据处理后进行展现。</p><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/640.png" height="304" width="718"/><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">WebAR 是两个概念，是 Web + AR，在 Web 端提供 AR 能力。Web 自身，依靠 WebGL 实时图形渲染 与 WebRTC 实时视频流处理能力，能够实现 AR 体验。但受其运行环境标准不一、渲染性能差等因素影响，我们在容器侧进行了能力干预支持，以保障其功能与性能体验等。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">在容器侧建设上，将 AR 能力集成到 App 上，再将 AR 能力提供给 WebView 使用（结合上面讲到的桥通道能力理解），以 H5 页的形式呈现。我们 Android 侧接入的是 UCWebView 提供的 AR 能力，使用 WebGL 渲染；iOS 是集成的 ARKit，通过全屏的 OpenGLView 上放置一个背景透明的 WebView 实现的混合渲染。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">两端提供了配置识别模块能力支持。目前识别主要分为两类：一类基于 Maker 的识别（此类是常用的，识别标记图），另一类是基于位置的识别（通俗理解是通过手机传感器的方向和位置增强沉浸感，如位置远显示的内容较小，反之则大）。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">当前小程序正如日中天，其有一项能力是很好的结合了 Native 与 H5，即“同层渲染”，下面我们也“纸上谈兵”一次。不过，我们也已有业务诉求，要做同层渲染的建设，将 Native 的 Video 等原生组件应用到 WebView 上满足业务体验需要。</p><hr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:1px;margin-top:10px;margin-bottom:10px;border-right:none;border-bottom:none;border-left:none;border-top-style:solid;border-top-color:black"/><h2 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:22px;margin:10px auto;height:40px;background-color:rgb(251,251,251);border-bottom:1px solid rgb(246,246,246);overflow:hidden"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-left:-10px;display:inline-block;width:auto;height:40px;background-color:rgb(33,33,34);border-bottom-right-radius:100px;color:rgb(255,255,255);padding-right:30px;padding-left:30px;line-height:40px;font-size:16px">同层渲染</span></h2><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">这里讲的同层渲染，是将 Native view 合成到 WebView 上，可以通过 CSS 控制 Native View 在页面的样式。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">以下介绍的两端方案，是基于目前笔者了解到的实现方案里最佳的。</p><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">Android</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">需要基于 Chromium 内核扩展自研的 WebView。Chromium 支持 WebPlugin 机制，用来识别解析 dom 标签。其思路：</p><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">html 里创建 dom 节点，指定组件类型，供容器识别处理</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">Chromium 创建 WebPlugin 实例，并生成 RenderLayer，其作用是创建独立的层并返回相应的画布供视图绘制使用</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">Android 根据识别的 组件类型 ，初始化一个对应的原生组件</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">Android 将原生组件的视图绘制 到 RenderLayer 所绑定的 SurfaceTexture 上（将 Android 的 UI Toolkit 的视图的数据送到 Texture 供 openGL 绘制使用）</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">Chromium 将此 RenderLayer 与 Web 页面的 View 进行合成渲染</div></li></ol><h3 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:20px;margin:20px auto 5px;border-top:1px solid rgb(221,221,221)"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:-1px;padding-top:6px;padding-right:5px;padding-left:5px;font-size:17px;border-top:2px solid rgb(33,33,34);display:inline-block;line-height:1.1">iOS</span></h3><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">基于 WKWebView，WK 在内部采用的是分层的方式进行渲染，一般会将多个 dom 节点，合并到一个层上进行渲染。因此，dom 节点和层之间不存在一一对应关系。但是，若将一个 dom 节点的 CSS 属性设置为 “overflow: scroll” 后，WKWebView 便会为其生成一个 WKChildScrollView，<strong style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important">且 WebKit 内核已经处理了 WKChildScrollView 与其他 dom 节点之间的层级关系</strong>，这时 dom 节点就和层之间有一一对应关系了。所以，同层渲染可基于 WKChildScrollView 实现：</p><ol style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:8px;margin-bottom:8px;padding-left:25px"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">html 里创建 din 节点并设置其 CSS 属性为 overflow: scroll，指定组件类型，供容器识别处理</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">iOS 查找到该 dom 节点对应的原生 WKChildScrollView 组件</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">iOS 根据识别的 组件类型 ，初始化一个对应的原生组件</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">iOS 将原生组件挂载到该 WKChildScrollView 节点上作为其子 view，这样原生组件就被插入到了 webView 上</div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-top:5px;margin-bottom:5px;line-height:26px;color:rgb(1,1,1);font-size:15px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif">WebKit 完成渲染</div></li></ol><hr style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:1px;margin-top:10px;margin-bottom:10px;border-right:none;border-bottom:none;border-left:none;border-top-style:solid;border-top-color:black"/><h2 style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-weight:bold;font-size:22px;margin:10px auto;height:40px;background-color:rgb(251,251,251);border-bottom:1px solid rgb(246,246,246);overflow:hidden"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin-left:-10px;display:inline-block;width:auto;height:40px;background-color:rgb(33,33,34);border-bottom-right-radius:100px;color:rgb(255,255,255);padding-right:30px;padding-left:30px;line-height:40px;font-size:16px">结语</span></h2><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;padding-top:8px;padding-bottom:8px;margin-bottom:16px;font-family:&quot;Helvetica Neue&quot;,Helvetica,&quot;Segoe UI&quot;,Arial,freesans,sans-serif;font-size:15px;white-space:normal;text-size-adjust:auto;line-height:1.75em">先到这了 ?</p><h2 style="font-weight:400;margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:18px;border-width:0;border-style:initial;border-color:initial;word-break:break-all;overflow-wrap:break-word;line-height:110px;height:110px;color:rgb(100,159,12);text-align:center;background-image:url(https://mmbiz.qpic.cn/mmbiz_png/MpGQUHiaib4ib6j9X9s2kibfaicBLmIm6dUBq1YM6xzAOuiaQW3qCATvwcQCI9Hh21gicUUnZ0FFtbjdVoCQMIZjDBUaA/640?wx_fmt=png);background-position:center center;background-size:150px 110px;background-repeat:no-repeat;background-attachment:initial;background-origin:initial;background-clip:initial;font-family:&quot;Helvetica Neue&quot;,Arial,&quot;Hiragino Sans GB&quot;,STHeiti,&quot;Microsoft YaHei&quot;;white-space:normal">关于奇舞周刊</h2><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em;margin-top:15px;margin-bottom:30px;border-width:0;border-style:initial;border-color:initial;line-height:2;font-size:14px;white-space:pre-wrap;word-break:break-all;overflow-wrap:break-word;hyphens:auto;color:rgb(136,136,136);font-family:&quot;Helvetica Neue&quot;,Arial,&quot;Hiragino Sans GB&quot;,STHeiti,&quot;Microsoft YaHei&quot;">《奇舞周刊》是360公司专业前端团队「<span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;border-width:0;border-style:initial;border-color:initial;font-weight:bold">奇舞团</span>」运营的前端技术社区。关注公众号后，直接发送链接到后台即可给我们投稿。</p><p style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;clear:both;min-height:1em"><img src="%E5%89%8D%E7%AB%AF%E9%9C%80%E8%A6%81%E6%87%82%E7%9A%84%20APP%20%E5%AE%B9%E5%99%A8%E5%8E%9F%E7%90%86.resources/640.jpg" height="318" width="922"/></p></div></div></div><ul style="margin:0;padding:0"/><div style="margin:0;padding:0;padding-top:15px;overflow:hidden;line-height:32px;font-size:15px"><div style="margin:0;padding:0;display:flex"><span style="margin:0;padding:0;float:right;margin-left:16px;color:#576b95;__visibility:hidden"><span style="margin:0;-webkit-appearance:none;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0;background-color:transparent;border:0;display:inline-block;vertical-align:middle;white-space:nowrap;padding:0;font-size:15px;font-family:inherit;line-height:2.13333333;color:#576b95"><span style="margin:0;padding:0">在看</span><span style="margin:0;padding:0;font-size:15px;margin-left:.2em"/></span></span></div></div></div></div></div></body></html>